<!-- Script para carregar residências e cômodos no modal de nova medição -->
<script>
// Carregar residências ao abrir o modal
document.getElementById('novaMedicaoModal').addEventListener('show.bs.modal', function() {
    fetch('/avaliawifi/api/residencias')
        .then(r => r.json())
        .then(residencias => {
            const select = document.getElementById('residenciaMedicao');
            select.innerHTML = '<option value="">Selecione uma residência</option>';
            residencias.forEach(r => {
                select.innerHTML += '<option value="' + r.id + '">' + r.nome + ' - ' + r.cliente + '</option>';
            });
        });
});

// Carregar cômodos quando residência for selecionada
document.getElementById('residenciaMedicao').addEventListener('change', function() {
    const residenciaId = this.value;
    const selectComodo = document.getElementById('comodoMedicao');
    
    if (!residenciaId) {
        selectComodo.innerHTML = '<option value="">Selecione um cômodo</option>';
        return;
    }
    
    fetch('/avaliawifi/api/comodos/' + residenciaId)
        .then(r => r.json())
        .then(comodos => {
            selectComodo.innerHTML = '<option value="">Selecione um cômodo</option>';
            comodos.forEach(c => {
                selectComodo.innerHTML += '<option value="' + c.id + '">' + c.nome + '</option>';
            });
        });
});
</script>
